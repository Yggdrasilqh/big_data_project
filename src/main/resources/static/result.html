<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Home</title>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <script type="application/x-javascript"> addEventListener("load", function () {
        setTimeout(hideURLbar, 0);
    }, false);
    function hideURLbar() {
        window.scrollTo(0, 1);
    } </script>
    <!-- Bootstrap Core CSS -->
    <link th:href="@{/css/bootstrap.min.css}" href="css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
    <!-- Custom CSS -->
    <link th:href="@{/css/style.css}" rel="stylesheet" href="css/style.css" type="text/css"/>
    <!-- Graph CSS -->
    <link th:href="@{/css/lines.css}" rel="stylesheet" href="css/lines.css" type="text/css"/>
    <link th:href="@{/css/font-awesome.css}" href="css/font-awesome.css" rel="stylesheet"/>
    <!-- jQuery -->
    <script th:src="@{/js/jquery.min.js}" src="js/jquery.min.js"></script>
    <!-- Nav CSS -->
    <link th:href="@{/css/custom.css}" href="css/custom.css" rel="stylesheet"/>
    <!-- Metis Menu Plugin JavaScript -->
    <script th:src="@{/js/metisMenu.min.js}" src="js/metisMenu.min.js"></script>
    <script th:src="@{/js/custom.js}" src="js/custom.js"></script>


</head>
<body>
<div id="wrapper">
    <!-- Navigation -->
    <nav class="top1 navbar navbar-default navbar-static-top" role="navigation"
         style="margin-bottom: 0;background-color: #00bcd4">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="random">JFCH</a>
        </div>

        <!-- /.navbar-header -->


        <!--<div class="navbar-default sidebar" role="navigation">-->
            <!--<div class="sidebar-nav navbar-collapse">-->
                <!--<ul class="nav in" id="side-menu">-->
                    <!--<li>-->
                        <!--<a href="../static/index.html" class="active"><i class="fa fa-dashboard fa-fw nav_icon"></i>Dashboard</a>-->
                    <!--</li>-->
                    <!--<li>-->
                        <!--<a href="#"><i class="fa fa-laptop nav_icon"></i>Layouts<span class="fa arrow"></span></a>-->
                        <!--<ul class="nav nav-second-level collapse">-->
                            <!--<li>-->
                                <!--<a href="../static/grids.html">Grid System</a>-->
                            <!--</li>-->
                        <!--</ul>-->
                        <!--&lt;!&ndash; /.nav-second-level &ndash;&gt;-->
                    <!--</li>-->
                    <!--<li>-->
                        <!--<a href="#"><i class="fa fa-indent nav_icon"></i>Menu Levels<span class="fa arrow"></span></a>-->
                        <!--<ul class="nav nav-second-level collapse">-->
                            <!--<li>-->
                                <!--<a href="../static/graphs.html">Graphs</a>-->
                            <!--</li>-->
                            <!--<li>-->
                                <!--<a href="../static/typography.html">Typography</a>-->
                            <!--</li>-->
                        <!--</ul>-->
                        <!--&lt;!&ndash; /.nav-second-level &ndash;&gt;-->
                    <!--</li>-->
                    <!--<li>-->
                        <!--<a href="#"><i class="fa fa-envelope nav_icon"></i>Mailbox<span class="fa arrow"></span></a>-->
                        <!--<ul class="nav nav-second-level collapse">-->
                            <!--<li>-->
                                <!--<a href="../static/inbox.html">Inbox</a>-->
                            <!--</li>-->
                            <!--<li>-->
                                <!--<a href="../static/compose.html">Compose email</a>-->
                            <!--</li>-->
                        <!--</ul>-->
                        <!--&lt;!&ndash; /.nav-second-level &ndash;&gt;-->
                    <!--</li>-->
                    <!--<li>-->
                        <!--<a href="../static/widgets.html"><i class="fa fa-flask nav_icon"></i>Widgets</a>-->
                    <!--</li>-->
                    <!--<li>-->
                        <!--<a href="#"><i class="fa fa-check-square-o nav_icon"></i>Forms<span class="fa arrow"></span></a>-->
                        <!--<ul class="nav nav-second-level collapse">-->
                            <!--<li>-->
                                <!--<a href="../static/forms.html">Basic Forms</a>-->
                            <!--</li>-->
                            <!--<li>-->
                                <!--<a href="../static/validation.html">Validation</a>-->
                            <!--</li>-->
                        <!--</ul>-->
                        <!--&lt;!&ndash; /.nav-second-level &ndash;&gt;-->
                    <!--</li>-->
                    <!--<li>-->
                        <!--<a href="#"><i class="fa fa-table nav_icon"></i>Tables<span class="fa arrow"></span></a>-->
                        <!--<ul class="nav nav-second-level collapse">-->
                            <!--<li>-->
                                <!--<a href="../static/basic_tables.html">Basic Tables</a>-->
                            <!--</li>-->
                        <!--</ul>-->
                        <!--&lt;!&ndash; /.nav-second-level &ndash;&gt;-->
                    <!--</li>-->
                    <!--<li>-->
                        <!--<a href="#"><i class="fa fa-sitemap fa-fw nav_icon"></i>Css<span class="fa arrow"></span></a>-->
                        <!--<ul class="nav nav-second-level collapse">-->
                            <!--<li>-->
                                <!--<a href="../static/media.html">Media</a>-->
                            <!--</li>-->
                            <!--<li>-->
                                <!--<a href="../static/login.html">Login</a>-->
                            <!--</li>-->
                        <!--</ul>-->
                        <!--&lt;!&ndash; /.nav-second-level &ndash;&gt;-->
                    <!--</li>-->
                <!--</ul>-->
            <!--</div>-->
            <!--&lt;!&ndash; /.sidebar-collapse &ndash;&gt;-->
        <!--</div>-->
        <!-- /.navbar-static-side -->
    </nav>

    <div id="" style="min-height: 678px;">
        <div class="graphs col-md-6" style="min-height: 1000px">
            <!--规则列表-->
            <div class="panel panel-warning" data-widget-static="" style="margin: 0 !important;">
                <div class="panel-body no-padding">
                    <h1 class="form-heading">网站列表</h1>
                    <hr/>
                    <table class="table table-striped">
                        <thead>
                        <tr class="warning">
                            <th>统计规则</th>
                            <!--<th>选择</th>-->
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td><a onclick="showDiagram(0)">访问最多的网站</a></td>
                            <!--<td><input type="radio" name="choose"/></td>-->
                        </tr>
                        <tr>
                            <td><a onclick="showDiagram(1)">男生访问最多的网站</a></td>
                            <!--<td><input type="radio" name="choose"/></td>-->
                        </tr>
                        <tr>
                            <td><a onclick="showDiagram(2)">女生访问最多的网站</a></td>
                            <!--<td><input type="radio" name="choose"/></td>-->
                        </tr>
                        <tr>
                            <td><a onclick="showDiagram(3)">指定时间区间内上网次数最多的学生姓名</a></td>
                            <!--<td><input type="radio" name="choose"/></td>-->
                        </tr>
                        <tr>
                            <td><a onclick="showDiagram(4)">指定时间区间内上网次数最多的男学生姓名</a></td>
                            <!--<td><input type="radio" name="choose"/></td>-->
                        </tr>
                        <tr>
                            <td><a onclick="showDiagram(5)">指定时间区间内上网次数最多的女学生姓名</a></td>
                            <!--<td><input type="radio" name="choose"/></td>-->
                        </tr>
                        <tr>
                            <td><a onclick="showDiagram(6)">以10分钟为区间，上网次数最多的时间区间</a></td>
                            <!--<td><input type="radio" name="choose"/></td>-->
                        </tr>
                        <tr>
                            <td><a onclick="showDiagram(7)">指定时间段，查看上网次数最多的学生学号</a></td>
                            <!--<td><input type="radio" name="choose"/></td>-->
                        </tr>
                        <tr>
                            <td><a onclick="showDiagram(8)">同时[5s以内]同时上同一个网站的男生列表</a></td>
                            <!--<td><input type="radio" name="choose"/></td>-->
                        </tr>
                        <tr>
                            <td><a onclick="showDiagram(9)">同时[5s以内]同时上同一个网站的女生列表</a></td>
                            <!--<td><input type="radio" name="choose"/></td>-->
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="graphs col-md-6" style="min-height: 1000px">
            <!--规则列表-->
            <div class="panel panel-success" data-widget-static="">
                <div class="panel-body no-padding">
                    <h1 class="form-heading">统计结果</h1>
                    <div style="float: right">
                        <input type="radio" name="type" onchange="changeType('polarArea')" checked/> 饼图
                        <input type="radio" name="type" onchange="changeType('bar')"/> 柱图
                        <input type="radio" name="type" onchange="changeType('line')"/> 条图
                    </div>
                    <canvas id="myChart" width="400" height="400"></canvas>
                </div>
            </div>
        </div>
    </div>
    <!-- /#page-wrapper -->
</div>
<script src="js/myChart.js"></script>

<script>
    var originData;
    var mychar;
    var type = "polarArea";
    var ctx = $("#myChart").get(0).getContext("2d");
    var a_id = 0;

    $(document).ready(function () {
        originData = getData();
        showDiagram(a_id);
    })

    function changeType(newType){
        type = newType;
        showDiagram(a_id);
        console.log(type)
    }

    function showDiagram(id) {
        a_id = id;
        //Get context with jQuery - using jQuery's .get() method.
        //This will get the first returned node in the jQuery collection.
        var myNewChart = new Chart(ctx);
        var keys = getKeys(originData);
        var numbers = getValues(originData, keys);

        if(keys.length > id) {
            var labelData = JSON.parse(keys[id]);
            var numberData = JSON.parse("[" + numbers[id] + "]");
            console.log(labelData);
            console.log(numberData);
//        var labelData = data.split(",");
//        var numberData = data.split
            if(mychar){
                mychar.destroy();
            }
            config = {
                type: type,
                data: {
                    labels: labelData,
                    datasets: [{
                        label: "人数",
                        data: numberData,
                        backgroundColor: [
                            'rgba(255, 99, 132, 0.2)',
                            'rgba(54, 162, 235, 0.2)',
                            'rgba(255, 206, 86, 0.2)',
                            'rgba(75, 192, 192, 0.2)',
                            'rgba(153, 102, 255, 0.2)',
                            'rgba(255, 159, 64, 0.2)'
                        ],
                        borderColor: [
                            'rgba(255,99,132,1)',
                            'rgba(54, 162, 235, 1)',
                            'rgba(255, 206, 86, 1)',
                            'rgba(75, 192, 192, 1)',
                            'rgba(153, 102, 255, 1)',
                            'rgba(255, 159, 64, 1)'
                        ],
                        borderWidth: 1
                    }]
                }
            };
            mychar = new Chart(ctx, config);
        }
    }

    function getData() {
        var dataName = getQueryString("dataName");
        var result;
        $.ajax({
            url: "/result/getByDataName",
            data: {dataName: dataName},
            async: false,
            success: function(data){
                result = data;
            }
        })
        return result;
    }

    function getValues(obj, keys){
        var list = new Array();
        for(var i = 0 ; i < keys.length ; i++){
            list.push(obj[keys[i]]);
        }
        return list;
    }

    function getKeys(obj) {
        var keys = new Array();
        for (var key in obj) {
//            if (obj.hasOwnProperty(key)) {
                keys.push(key);
//            }
        }
        return keys;
    }

    function toArray(obj) {
        var keys = new Array();
        for (var key in obj) {
            keys.push(key);
        }
    }

    function getQueryString(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
        var r = window.location.search.substr(1).match(reg);
        if (r !== null)
            return decodeURI(r[2]);
        return null;
    }

</script>
</body>
</html>